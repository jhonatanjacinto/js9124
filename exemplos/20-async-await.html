<meta charset="utf-8">
<h1>Promises com Async/Await</h1>
<p id="mostrador"></p>

<script>

    function conectarNoBancoDeDados()
    {
        return new Promise((resolve, reject) => {
            mostrador.innerHTML = "Conectando no banco de dados...";
            setTimeout(() => {
                alert("Conexão realizada com sucesso!");
                resolve(); // executa a função resolve() porque a promise foi processada com sucesso
            }, 3000)
        });
    }

    function buscarListaAssentos() {
        return new Promise((resolve, reject) => {
            mostrador.innerHTML = "Buscando lista de assentos disponíveis...";
            setTimeout(() => {
                alert("Pronto! Há 20 assentos disponíveis...");
                resolve();
            }, 5000);
        });
    }

    function registrarAssento() {
        return new Promise((resolve, reject) => {
            mostrador.innerHTML = "Registrando o assento 25...";
            setTimeout(() => {
                // qualquer erro na promise.. vai pro catch()
                // throw new Error("Não foi possível registra o assento solicitado!!!");
                alert("Legal! Assento 25 registrado com sucesso...");
                resolve();
            }, 4000);
        })
    }

    function realizarPagamento() {
        return new Promise((resolve, reject) => {
            mostrador.innerHTML = "Processando o pagamento...";
            setTimeout(() => {
                alert("Pagamento autorizado com sucesso...");
                resolve();
            }, 3000);
        });
    }

    // Processamento assíncrono com Promises e Async/Await
    async function processarPassos()
    {
        try {
            await conectarNoBancoDeDados();
            await buscarListaAssentos();
            await registrarAssento();
            await realizarPagamento();
            mostrador.innerHTML = "Processamento realizado com sucesso!";
        }
        catch(erro) {
            alert(erro);
            console.error(erro);
        }
    }

    processarPassos();

</script>